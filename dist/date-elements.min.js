/**
 * Copyright (c) 2015, Leo Di Donato <leodidonato@gmail.com>
 * ng-date-elements.js - AngularJS directives for date elements
 * @version 0.1.0
 * @link http://github.com/leodido/ng-date-elements
 * @license MIT
 */
(function(){function h(a,c,b){return a.call.apply(a.bind,arguments)}function l(a,c,b){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(b,d);return a.apply(c,b)}}return function(){return a.apply(c,arguments)}}function m(a,c,b){m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf('native code')?h:l;return m.apply(null,arguments)}
function n(a,c){function b(){}b.prototype=c.prototype;a.r=c.prototype;a.prototype=new b;a.prototype.constructor=a;a.q=function(a,b,e){for(var k=Array(arguments.length-2),g=2;g<arguments.length;g++)k[g-2]=arguments[g];return c.prototype[b].apply(a,k)}};var p=['MMMM','MMM','MM','M'],q=p[2];function t(){}t.prototype.a=function(){return{restrict:'A',transclude:!0,replace:!1,template:'<div ng-transclude></div>',controller:this.controller}};t.prototype.controller=function(a,c){a.options=a.$eval(c.options);this.d=[];this.addSelect=function(a){var d=this;this.d.push(a);a.$on('$destroy',function(){d.removeSelect(a)})};this.removeSelect=function(a){a=this.d.indexOf(a);-1!==a&&this.d.splice(a,1)}};t.prototype.controller.$inject=['$scope','$attrs'];function u(a,c,b,d){var f=this;this.e=function(){a.element=a.element||{};a.element.opts=[];for(var e=f.g(),d=f.h();e<=d;e++)a.element.opts.push({index:e,label:f.b(e),value:f.c(e)})};this.p=function(a){return angular.isDefined(a)&&a.index>=this.g()&&a.index<=this.h()&&a.value===this.c(a.index)&&a.label===this.b(a.index)};this.i=function(b,c){var f={};f[b]=c;return d('filter')(a.element.opts,f,!0)};this.g=function(){return+a.first};this.h=function(){return+a.last}}
u.$inject=['$scope','$element','$attrs','$filter'];function v(){var a='',c='',b='';this.f=function(){return c};this.o=function(){return b};this.n=function(){return a};this.k=function(a){if(/[^a-zA-Z]/.test(a))throw new TypeError('alpha string required; received "'+typeof a+'"');c=a;b=c.match(/([A-Z]?[^A-Z]*)/g).shift();return this};this.j=function(b){if(!angular.isString(b))throw new TypeError('string required; received "'+typeof b+'"');a=b;return this}}
v.prototype.a=function(){return{restrict:'AC',replace:!0,require:[this.f(),'ngModel','?^^selectAggregate'],scope:{emptyOption:'@',format:'@',first:'@',last:'@'},controller:this.n(),link:m(this.link,this),template:'<select data-ng-model="model" data-ng-options="opt as opt.label for opt in element.opts track by opt.value" ><option value="" data-ng-disabled="true" data-ng-hide="!emptyOption">{{emptyOption}}</option></select>'}};
v.prototype.link=function(a,c,b,d){if(!(2>d.length)){var f=d[0],e=d[1];c=d[2];d=this.f();var k=this.o(),g=function(b){e.$selection=b;a.$emit(e.$name+'.selection',b)},r=function(a){var b=f.p(a);e.$setValidity(k,b);if(b)return g(a),a;g(null);return!1};c&&c.addSelect(k,a);f.e();b.$observe(d,function(b){b=f.i('value',b);1===b.length&&(a.model=b[0])});b.$observe('value',function(b){b=f.i('label',b);1===b.length&&angular.isUndefined(a.model)&&(a.model=b[0])});e.$parsers.unshift(r);e.$formatters.unshift(r)}};
v.prototype.link.$inject=['$scope','$element','$attrs','controllers'];function w(a,c,b,d){u.call(this,a,0,0,d);var f=this;b.$set('first','0');b.$set('last','11');a.$watch('format',function(a){1!=d('filter')(p,a,!0).length&&(b.$set('format',q),f.e())});this.l=function(b){return d('date')((new Date).setMonth(b),a.format)}}n(w,u);w.$inject=['$scope','$element','$attrs','$filter'];w.prototype.c=function(a){return(a+1).toString()};w.prototype.b=function(a){return this.l(a)};function x(){v.call(this)}n(x,v);var y=['yyyy','yy','y'],z=y[0],A=(new Date).getFullYear(),B=A+10;function C(a,c,b,d){u.call(this,a,0,0,d);var f=this,e=!1;a.$watchGroup(['format','first','last'],function(c){e&&f.e();var g=c[2],r=c[0];/^\d{4}$/.test(c[1])||(b.$set('first',''+A),e=!0);/^\d{4}$/.test(g)||(b.$set('last',''+B),e=!0);a.first>a.last&&(a.first^=a.last,a.last^=a.first,a.first^=a.last,e=!0);1!==d('filter')(y,r,!0).length&&(b.$set('format',z),e=!0)});this.m=function(b){return d('date')(new Date(b.toString()),a.format)}}n(C,u);C.$inject=['$scope','$element','$attrs','$filter'];
C.prototype.c=function(a){return a.toString()};C.prototype.b=function(a){return this.m(a)};function D(){v.call(this)}n(D,v);angular.module('leodido.dateElements',[]).directive('selectComposite',function(){return(new t).a()}).controller('MonthSelectController',w).directive('monthSelect',function(){return(new x).k('monthSelect').j('MonthSelectController').a()}).controller('YearSelectController',C).directive('yearSelect',function(){return(new D).k('yearSelect').j('YearSelectController').a()});})();
